<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>ƒ∞stemci ‚Äì ≈ûifreleme</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- üåà GLOBAL STYLE -->
  <style>
/* =========================
   GLOBAL
========================= */
body {
  min-height: 100vh;
  background:
    radial-gradient(circle at top left, #a78bfa 0%, transparent 45%),
    radial-gradient(circle at bottom right, #f0abfc 0%, transparent 45%),
    linear-gradient(180deg, #0b0b14, #111827);
  font-family: "Inter", system-ui, -apple-system, sans-serif;
  color: #e5e7eb;
}

/* TITLES */
h2 {
  font-weight: 800;
  letter-spacing: 0.6px;
  background: linear-gradient(90deg, #c4b5fd, #f5d0fe);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

label { color: #c7d2fe !important; }

/* CONTAINER */
.container { max-width: 900px; }

/* CARD */
.card {
  background: rgba(255, 255, 255, 0.07);
  backdrop-filter: blur(18px);
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: 0 25px 60px rgba(0,0,0,0.55);
}

/* INPUTS */
.form-control,
.form-select {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.2);
  color: #f1f5f9;
  border-radius: 16px;
}

/* BUTTONS */
.btn {
  border-radius: 18px;
  font-weight: 700;
  transition: all 0.25s ease;
}

.btn-primary {
  background: linear-gradient(135deg, #a78bfa, #f0abfc);
  border: none;
  color: #1e1b4b;
}

.btn-success {
  background: linear-gradient(135deg, #8b5cf6, #d946ef);
  border: none;
  color: #faf5ff;
}

/* SWITCH BAR */
.switch-bar {
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-bottom: 28px;
}

.switch-btn {
  padding: 10px 22px;
  border-radius: 999px;
  font-weight: 700;
  border: 1px solid rgba(255,255,255,0.3);
  background: rgba(255,255,255,0.08);
  color: #e5e7eb;
  cursor: pointer;
}

.switch-btn.active {
  background: linear-gradient(135deg, #a78bfa, #f0abfc);
  color: #1e1b4b;
}
/* =========================
   SELECT DROPDOWN ‚Äì FIX
========================= */
select,
select option {
  background-color: #0f172a !important; /* koyu arka plan */
  color: #f8fafc !important;            /* a√ßƒ±k yazƒ± */
}

/* Hover */
select option:hover {
  background-color: #7c3aed !important;
  color: #ffffff !important;
}

/* Se√ßili option */
select option:checked {
  background-color: #9333ea !important;
  color: #ffffff !important;
}

  </style>
</head>

<body>

<div class="container py-5">

  <!-- üîÅ PAGE SWITCH -->
  <div class="switch-bar">
    <div class="switch-btn active">ƒ∞stemci (≈ûifreleme)</div>
    <div class="switch-btn" onclick="window.location.href='/decrypt/'">
      Sunucu (De≈üifreleme)
    </div>
  </div>

  <h2 class="mb-4 text-center">üîê ƒ∞stemci ‚Äì ≈ûifreleme</h2>
<form id="encryptForm" class="card p-4">
  <div class="mb-3">
    <label>Algoritma</label>
    <select id="method" class="form-select">

      <!-- üîê KLASƒ∞K ≈ûƒ∞FRELER -->
      <option value="caesar">Caesar Cipher</option>
      <option value="vigenere">Vigen√®re Cipher</option>
      <option value="affine">Affine Cipher</option>
      <option value="substitution">Substitution Cipher</option>
      <option value="railfence">Rail Fence Cipher</option>
      <option value="columnar">Columnar Transposition</option>
      <option value="hill">Hill Cipher</option>
      <option value="vernam">Vernam Cipher</option>

      <!-- üîí MODERN (LIBRARY) -->
      <option value="aes_lib">AES + RSA (Library)</option>
      <option value="des_lib">DES + RSA (Library)</option>

      <!-- üß™ MANUAL -->
      <option value="aes_manual">AES (Manual)</option>
      <option value="des_manual">DES (Manual)</option>

    </select>
  </div>

  <div class="mb-3">
    <label>Anahtar</label>
    <input id="key" class="form-control">
  </div>

  <div class="mb-3">
    <label>Mesaj</label>
    <textarea id="message" class="form-control"></textarea>
  </div>

  <div class="mb-3">
    <label>Dosya</label>
    <input type="file" id="file" class="form-control">
  </div>

  <button class="btn btn-primary w-100">≈ûifrele</button>
</form>

</div>
<script>
document.getElementById("encryptForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const method  = document.getElementById("method").value;
  const keyRaw  = document.getElementById("key").value.trim();
  const message = document.getElementById("message").value.trim();
  const file    = document.getElementById("file").files[0];

  let url = "";
  let options = {};

  if (!file && !message) {
    alert("Mesaj veya dosya gerekli");
    return;
  }

  /* =====================================================
     AFFINE KEY PARSE (a,b)
  ===================================================== */
  let a = null, b = null;
  if (method === "affine") {
    if (!keyRaw.includes(",")) {
      alert("Affine anahtarƒ± a,b formatƒ±nda olmalƒ± (√∂rn: 5,8)");
      return;
    }

    [a, b] = keyRaw.split(",").map(Number);

    if (isNaN(a) || isNaN(b)) {
      alert("Affine anahtarƒ±nda a ve b sayƒ± olmalƒ±");
      return;
    }
  }

  /* =====================================================
     FILE VARSA
  ===================================================== */
  if (file) {
    const fd = new FormData();
    fd.append("file", file);

    if (method === "affine") {
      fd.append("a", a);
      fd.append("b", b);
    } else if (keyRaw) {
      fd.append("key", keyRaw);
    }

    switch (method) {
      case "aes_lib":        url = "/encrypt-file/"; break;
      case "des_lib":        url = "/encrypt-file-des/"; break;
      case "aes_manual":     url = "/receive-aes-manual/"; break;
      case "des_manual":     url = "/receive-des-manual/"; break;

      case "caesar":         url = "/file/caesar/encrypt/"; break;
      case "vigenere":       url = "/file/vigenere/encrypt/"; break;
      case "affine":         url = "/file/affine/encrypt/"; break;
      case "substitution":   url = "/file/substitution/encrypt/"; break;
      case "railfence":      url = "/file/railfence/encrypt/"; break;

      default:
        alert("Dosya i√ßin desteklenmeyen algoritma");
        return;
    }

    options = { method: "POST", body: fd };
  }

  /* =====================================================
     FILE YOKSA ‚Üí TEXT
  ===================================================== */
  else {

    /* ===== AES + RSA ===== */
    if (method === "aes_lib") {
      url = "/receive/";
      options = {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      };
    }

    /* ===== DES + RSA ===== */
    else if (method === "des_lib") {
      url = "/receive-des-lib/";
      options = {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message })
      };
    }

    /* ===== AES MANUAL ===== */
    else if (method === "aes_manual") {
      url = "/receive-aes-manual/";
      options = {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message, key: keyRaw })
      };
    }

    /* ===== DES MANUAL ===== */
    else if (method === "des_manual") {
      url = "/receive-des-manual/";
      options = {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message, key: keyRaw })
      };
    }

    /* ===== KLASƒ∞K ≈ûƒ∞FRELER ===== */
    else {
      const fd = new FormData();
      fd.append("message", message);

      if (method === "affine") {
        fd.append("a", a);
        fd.append("b", b);
      } else if (keyRaw) {
        fd.append("key", keyRaw);
      }

      switch (method) {
        case "caesar":        url = "/encrypt/"; break;
        case "vigenere":      url = "/vigenere/encrypt/"; break;
        case "affine":        url = "/affine/encrypt/"; break;
        case "substitution":  url = "/substitution/encrypt/"; break;
        case "railfence":     url = "/railfence/encrypt/"; break;
        case "columnar":      url = "/columnar/encrypt/"; break;
        case "hill":          url = "/hill/encrypt/"; break;
        case "vernam":        url = "/vernam/encrypt/"; break;

        default:
          alert("Desteklenmeyen algoritma");
          return;
      }

      options = { method: "POST", body: fd };
    }
  }

  /* =====================================================
     FETCH
  ===================================================== */
  try {
    const res = await fetch(url, options);
    const data = await res.json();

    localStorage.setItem("ciphertext", data.ciphertext || data.result);
    localStorage.setItem("method", method);

    if (data.encrypted_key) {
      localStorage.setItem("encrypted_key", data.encrypted_key);
    }

    window.location.href = "/decrypt/";
  }
  catch (err) {
    alert("Sunucu hatasƒ±");
    console.error(err);
  }
});
</script>


</body>
</html>
