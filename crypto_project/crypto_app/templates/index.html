<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ” Mesaj Åifreleme Ä°stemcisi</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body class="bg-light">
  <div class="container py-5 text-center">
    <h2 class="mb-4 text-primary">ğŸ” Mesaj Åifreleme UygulamasÄ±</h2>
    
    <form id="encryptForm" class="card p-4 shadow-sm">

      <!-- Åifreleme YÃ¶ntemi -->
      <div class="mb-3">
        <label class="form-label">Åifreleme YÃ¶ntemi</label>
        <select class="form-select" name="method" id="methodSelect">
          <option value="caesar">Caesar Cipher</option>
          <option value="vigenere">VigenÃ¨re Cipher</option>
          <option value="affine">Affine Cipher</option>
          <option value="substitution">Substitution Cipher</option>
          <option value="railfence">Rail Fence Cipher</option>
          <option value="columnar">Columnar Transposition Cipher</option>
          <option value="hill">Hill Cipher</option>
          <option value="vernam">Vernam Cipher</option>
          <option value="aes">AES-Lite Cipher</option> <!-- ğŸ”¥ YENÄ° EKLENDÄ° -->
        </select>
      </div>

      <!-- Anahtar AlanlarÄ± -->
      <div id="keyFields">
        <!-- Normal key -->
        <div class="mb-3" id="keySingle">
          <label class="form-label">Anahtar / KaydÄ±rma</label>
          <input type="text" name="key" class="form-control" value="3" />
        </div>

        <!-- Affine -->
        <div class="row" id="keyAffine" style="display:none;">
          <div class="col">
            <label class="form-label">a DeÄŸeri</label>
            <input type="number" name="a" class="form-control" value="5" />
          </div>
          <div class="col">
            <label class="form-label">b DeÄŸeri</label>
            <input type="number" name="b" class="form-control" value="8" />
          </div>
        </div>

        <!-- Substitution -->
        <div class="mb-3" id="keySubstitution" style="display:none;">
          <label class="form-label">Alfabe AnahtarÄ± (26 Harf)</label>
          <input type="text" name="keySub" class="form-control" value="QWERTYUIOPASDFGHJKLZXCVBNM">
        </div>

        <!-- Columnar -->
        <div class="mb-3" id="keyColumnar" style="display:none;">
          <label class="form-label">SÃ¼tun AnahtarÄ±</label>
          <input type="text" name="keyColumnar" class="form-control" value="KEY">
        </div>

        <!-- Vernam -->
        <div class="mb-3" id="keyVernam" style="display:none;">
          <label class="form-label">Vernam AnahtarÄ±</label>
          <input type="text" name="keyVernam" class="form-control" value="SECRET">
        </div>

        <!-- AES-Lite -->
        <div class="mb-3" id="keyAES" style="display:none;">
          <label class="form-label">AES AnahtarÄ±</label>
          <input type="text" name="keyAES" class="form-control" value="KEY123">
        </div>

        <!-- Hill info -->
        <div class="alert alert-info small mt-2" id="hillInfo" style="display:none;">
          Hill Cipher sabit matris: [[3,3],[2,5]]
        </div>
      </div>

      <!-- Mesaj -->
      <div class="mb-3">
        <label class="form-label">Mesaj</label>
        <textarea name="message" class="form-control" rows="3"></textarea>
      </div>

      <button class="btn btn-primary w-100">ğŸ”’ Åifrele</button>
    </form>

    <div class="mt-4">
      <h5>ğŸ§© Åifreli Mesaj:</h5>
      <p id="result" class="fw-bold text-success"></p>
    </div>
  </div>

<script>
const methodSelect = document.getElementById("methodSelect");
const keySingle = document.getElementById("keySingle");
const keyAffine = document.getElementById("keyAffine");
const keySubstitution = document.getElementById("keySubstitution");
const keyColumnar = document.getElementById("keyColumnar");
const keyVernam = document.getElementById("keyVernam");
const keyAES = document.getElementById("keyAES");
const hillInfo = document.getElementById("hillInfo");

// Metoda gÃ¶re alan gÃ¶sterme/gizleme
methodSelect.onchange = () => {
  [keySingle, keyAffine, keySubstitution, keyColumnar, keyVernam, keyAES, hillInfo]
    .forEach(e => e.style.display = "none");

  const m = methodSelect.value;

  if (["caesar", "vigenere", "railfence"].includes(m)) keySingle.style.display = "block";
  else if (m === "affine") keyAffine.style.display = "flex";
  else if (m === "substitution") keySubstitution.style.display = "block";
  else if (m === "columnar") keyColumnar.style.display = "block";
  else if (m === "vernam") keyVernam.style.display = "block";
  else if (m === "aes") keyAES.style.display = "block";  // AES key alanÄ±
  else if (m === "hill") hillInfo.style.display = "block";
};

// Form gÃ¶nderimi
document.getElementById("encryptForm").onsubmit = async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const method = formData.get("method");

  let url = "";
  if (method === "caesar") url = "/encrypt/";
  else if (method === "vigenere") url = "/vigenere/encrypt/";
  else if (method === "affine") url = "/affine/encrypt/";
  else if (method === "substitution") url = "/substitution/encrypt/";
  else if (method === "railfence") url = "/railfence/encrypt/";
  else if (method === "columnar") url = "/columnar/encrypt/";
  else if (method === "hill") url = "/hill/encrypt/";
  else if (method === "vernam") url = "/vernam/encrypt/";
  else if (method === "aes") url = "/aes/encrypt/";

  // Ã¶zel isimlerin eÅŸitlenmesi
  if (method === "substitution") formData.set("key", formData.get("keySub"));
  else if (method === "columnar") formData.set("key", formData.get("keyColumnar"));
  else if (method === "vernam") formData.set("key", formData.get("keyVernam"));
  else if (method === "aes") formData.set("key", formData.get("keyAES"));

  const res = await fetch(url, { method: "POST", body: formData });
  const data = await res.json();
  document.getElementById("result").innerText = data.result || "âŒ Hata oluÅŸtu.";
};
</script>
</body>
</html>
